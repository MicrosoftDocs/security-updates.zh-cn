---
TOCTitle: 'MS04-012'
Title: 'Microsoft 安全公告 MS04-012 - 严重'
ms:assetid: 'ms04-012'
ms:contentKeyID: 61236576
ms:mtpsurl: 'https://technet.microsoft.com/zh-CN/library/ms04-012(v=Security.10)'
---

Microsoft 安全公告 MS04-012 - 严重
==================================

Microsoft RPC/DCOM 的累积性更新 (828741)
----------------------------------------

发布时间: 2004年4月13日 | 更新时间: 2004年4月21日

**发布日期：** 2004 年 4 月 13 日  
**版本：** 1.0  

#### 摘要

**本文的目标读者：** 使用Microsoft® Windows® 的用户

**漏洞的影响：** 远程执行代码

**最高严重等级：** 严重

**建议：** 用户应立即应用此更新。

**安全更新替代：** 本公告替代多个以前的安全更新。有关完整列表，请参见本公告的"常见问题解答"(FAQ) 部分。

**注意事项：** 无

**测试过的软件和安全更新下载位置：**  

**受影响的软件**  

-   Microsoft Windows NT® Workstation 4.0 Service Pack 6a – [下载此更新](https://www.microsoft.com/download/details.aspx?displaylang=zh-cn&familyid=4acb5bd6-a0bf-40bc-8955-d833923642ef)
-   Microsoft Windows NT Server 4.0 Service Pack 6a – [下载此更新](https://www.microsoft.com/download/details.aspx?displaylang=zh-cn&familyid=d4f2ad32-fe74-4da1-aeae-80897ac86720)
-   Microsoft Windows NT Server 4.0 终端服务器版 Service Pack 6 – [下载此更新](https://www.microsoft.com/download/details.aspx?familyid=5b29e35d-e5da-4486-b7eb-d54c7398142c&displaylang=en)
-   Microsoft Windows 2000 Service Pack 2, Microsoft Windows 2000 Service Pack 3, and Microsoft Windows 2000 Service Pack 4 – [下载此更新](https://www.microsoft.com/download/details.aspx?displaylang=zh-cn&familyid=fbd38c36-d1d3-47a2-a5d5-6c8f27fdcc40)
-   Microsoft Windows XP and Microsoft Windows XP Service Pack 1 – [下载此更新](https://www.microsoft.com/download/details.aspx?displaylang=zh-cn&familyid=d488bbbb-da77-448d-8ff0-0a649a0d8fc3)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1 – [下载此更新](https://www.microsoft.com/download/details.aspx?familyid=4c3ed21d-ff40-4c9d-99dd-1632e43c1645&displaylang=en)
-   Microsoft Windows XP 64-Bit Edition Version 2003 – [下载此更新](https://www.microsoft.com/download/details.aspx?familyid=75a08528-5e99-4be0-8e97-f1c9789611eb&displaylang=en)
-   Microsoft Windows Server™ 2003 – [下载此更新](https://www.microsoft.com/download/details.aspx?displaylang=zh-cn&familyid=07317ce9-520d-4574-b575-5fb85da9a4d7)
-   Microsoft Windows Server 2003 64-Bit Edition – [下载此更新](https://www.microsoft.com/download/details.aspx?familyid=75a08528-5e99-4be0-8e97-f1c9789611eb&displaylang=en)
-   Microsoft Windows 98、Microsoft Windows 98 Second Edition (SE)、Microsoft Windows Millennium Edition (ME) – 有关这些操作系统的详细信息，请参见本公告中的“常见问题解答”部分。

已对上面列出的软件进行了测试，以确定这些版本是否受到影响。其他版本或者不再包括安全更新支持，或者可能不受影响。请访问 [Microsoft Support Lifecycle Web 站点](http://go.microsoft.com/fwlink/?linkid=21742)确定产品和版本的支持周期。

### 一般信息

详细技术资料
------------

**摘要：**  

此更新解决了在 RPC/DCOM 中新发现的一些漏洞。这些漏洞在本公告中都有各自相应的章节加以说明。

如果攻击者成功地利用这些漏洞中最严重的漏洞，就可以完全控制受影响的系统。接下来，攻击者能够对受影响的系统执行任何操作，包括安装程序、查看数据、更改数据、删除数据或者创建具有完全权限的新帐户。

Microsoft 建议客户立即应用此更新。

**严重等级和漏洞标识:**  

| 漏洞标识                                                                                                                            | 漏洞的影响   | Windows 98, 98 SE, ME | Windows NT Workstation 4.0 | Windows NT Server 4.0 | Windows NT Server 4.0, 终端服务器版 | Windows 2000 | Windows XP | Windows Server 2003 |
|-------------------------------------------------------------------------------------------------------------------------------------|--------------|-----------------------|----------------------------|-----------------------|-------------------------------------|--------------|------------|---------------------|
| RPC 运行时库漏洞 - [CAN-2003-0813](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0813)                                 | 远程执行代码 | 无                    | 无                         | 无                    | 无                                  | 严重         | 严重       | 严重                |
| RPCSS 服务漏洞 - [CAN-2004-0116](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0116)                                   | 拒绝服务     | 无                    | 无                         | 无                    | 无                                  | 重要         | 重要       | 重要                |
| COM Internet Services (CIS) – RPC over HTTP 漏洞 - [CAN-2003-0807](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0807) | 拒绝服务     | 无                    | 无                         | 低                    | 低                                  | 低           | 无         | 低                  |
| Object Identity 漏洞 - [CAN-2004-0124](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0124)                             | 信息泄露     | 不严重                | 低                         | 低                    | 低                                  | 低           | 低         | 低                  |
| **所有漏洞的综合严重程度**                                                                                                          |              | **不严重**            | **低**                     | **低**                | **低**                              | **严重**     | **严重**   | **严重**            |

以上[评估](http://go.microsoft.com/fwlink/?linkid=21140)基于受此漏洞影响的系统类型、其典型部署模式以及利用此漏洞会对它们产生什么影响而作出的。

与此安全更新有关的常见问题解答 (FAQ)
------------------------------------

**此次发布的更新将替代哪些更新？**  
此安全更新将替代多个以前的安全公告。安全公告 ID 和受影响的操作系统都列出在下表中。

| 公告 ID                                                                                                                                | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|----------------------------------------------------------------------------------------------------------------------------------------|----------------|--------------|------------|---------------------|
| [**MS98-014**](http://technet.microsoft.com/security/bulletin/ms98-014)                                                                | 已替代         | 不适用       | 不适用     | 不适用              |
| [](http://technet.microsoft.com/security/bulletin/ms00-066)[**MS00-066**](http://technet.microsoft.com/security/bulletin/ms00-066)</a> | 不适用         | 已替代       | 不适用     | 不适用              |
| [**MS01-048**](http://technet.microsoft.com/security/bulletin/ms01-048)                                                                | 已替代         | 不适用       | 不适用     | 不适用              |
| [**MS03-010**](http://technet.microsoft.com/security/bulletin/ms03-010)                                                                | 不适用         | 已替代       | 已替代     | 不适用              |
| [**MS03-026**](http://technet.microsoft.com/security/bulletin/ms03-026)                                                                | 已替代         | 已替代       | 已替代     | 已替代              |
| [**MS03-039**](http://technet.microsoft.com/security/bulletin/ms03-039)                                                                | 已替代         | 已替代       | 已替代     | 已替代              |

**此更新是累积性安全更新吗？**  
是的。此累积性安全更新支持上表中列出的所有以前的 RPC/DCOM 更新。

**延长对 Windows 98、Windows 98 Second Edition 和 Windows Millennium Edition 的支持对这些操作系统的安全更新发布有何影响？**  
Microsoft 只针对严重的安全问题发布安全更新。在支持期内，不会为不严重的安全问题提供安全更新。有关这些操作系统的 Microsoft 支持周期策略的更多信息，请访问以下[Web 站点](http://support.microsoft.com/default.aspx?pr=lifean1)。

有关严重等级的更多信息，请访问以下 [Web 站点](http://go.microsoft.com/fwlink/?linkid=21140)。

**本安全公告中解决的漏洞是否会对 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 造成严重影响？**  
不会。这些漏洞中的任何一个都不会对 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 造成严重影响。

**可以使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新吗？**  
可以。MBSA 将确定是否需要此更新。有关 MBSA 的更多信息，请访问 [MBSA Web 站点](http://go.microsoft.com/fwlink/?linkid=21134)。

**可以使用 Systems Management Server (SMS) 确定是否需要此更新吗？**  
可以。SMS 可以帮助检测和部署此安全更新。有关 SMS 的信息，请访问 [SMS Web 站点](http://go.microsoft.com/fwlink/?linkid=21158)。

**什么是远程过程调用 (RPC)？**  
[远程过程调用 (RPC)](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/rpc/rpc/how_rpc_works.asp) 是 Windows 操作系统使用的一项协议。RPC 提供了一种进程间的通信机制，该机制允许在一个系统上运行的程序顺畅地访问另一个系统上的服务。该协议本身是从开放式软件基础(OSF) RPC 协议衍生出来的，其中增加了一些 Microsoft 特定的扩展。

漏洞的详细资料
--------------

#### RPC 运行时库漏洞 - CAN-2003-0813:

如果 RPC 运行时间库在处理特制邮件时出现[争用情况](http://go.microsoft.com/fwlink/?linkid=21142) ，将引起远程执行代码漏洞。如果攻击者成功地利用了此漏洞，即可完全控制受影响的系统。但是，在最可能的攻击方案中，此问题是一个[拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142) 漏洞。

#### RPC 运行时库漏洞的缓解因素 - CAN-2003-0813:

-   采用防火墙最佳做法和标准的默认防火墙配置，有助于保护网络免受源自企业防线外部的攻击。按照最佳做法，应使连接到 Internet 的系统所暴露的端口数尽可能少。
-   Windows NT 4.0 is not affected by this 漏洞 .

#### RPC 运行时库漏洞 - CAN-2003-0813 的变通办法：

Microsoft 已测试过以下变通办法。虽然这些变通办法不会从根本上消除漏洞，但它们有助于阻塞已知的攻击媒介。如果某种变通办法会导致功能下降，将在下面进行说明。

-   **使用 Windows XP 和 Windows Server 2003 附带的个人防火墙，如** [**Internet 连接防火墙**](http://www.microsoft.com/security/protect/windowsxp/firewall.asp)**。**  

    如果使用 Windows XP 或 Windows Server 2003 中的 Internet 连接防火墙功能帮助保护 Internet 连接，则在默认情况下，该防火墙将阻塞未经请求的入站流量。Microsoft 建议阻塞所有来自 Internet 的未经请求的入站通信。

    要使用网络安装向导来启用 Internet 连接防火墙功能，请按照以下步骤进行操作：

    1.  单击**“开始”**，然后单击 **“控制面板”**。
    2.  在默认的**“分类视图”**中，单击**“网络和 Internet 连接”**，然后单击“设置或更改您的家庭或小型办公网络”。当在网络安装向导中将系统配置为直接连接至 Internet 后，Internet 连接防火墙功能随即启用。

    要为某一连接手动配置 Internet 连接防火墙，请按照以下步骤进行操作：

    1.  单击 **“开始”**，然后单击 **“控制面板”**。
    2.  在默认的**“分类视图”中**中，单击**“网络和 Internet 连接”**，然后单击 **“网络连接”**。
    3.  右键单击您要启用“Internet 连接防火墙”的连接，然后单击**“属性”**。
    4.  单击**“高级”**选项卡。
    5.  单击选中 **“通过限制或阻止从 Internet 访问此计算机来保护我的计算机或网络”** 复选框，然后单击**“确定”**。

    **注意** 如果您想通过防火墙启用某些应用程序和服务，请单击 **“高级”** 选项卡上的**“设置”** ，然后选择所需的程序、协议及服务。

-   **在防火墙处阻塞以下端口：**  

    -   **UDP 端口 135、137、138 和 445；TCP 端口 135、139、445 和 593**  
    -   **端口号大于 1024 的端口上所有未经请求的入站流量**  
    -   **任何其他特别配置的 RPC 端口**  
    -   **用于监听端口 80 和 443 的 COM Internet 服务 (CIS) 或 RPC over HTTP（如果已安装）**  

    这些端口用于初始化与 RPC 的连接。将其阻塞在防火墙处，有助于保护位于防火墙后面的系统免受利用此漏洞进行的攻击。此外，还要确保阻塞了远程系统上任何其他特别配置的 RPC 端口。Microsoft 建议阻塞所有来自 Internet 的未经请求的入站通信，以帮助阻止可能使用其他端口进行的攻击。有关 RPC 所使用的端口的更多信息，请访问以下 [Web 站点](http://go.microsoft.com/fwlink/?linkid=21312)。有关如何禁用 CIS 的更多信息，请参见 Microsoft 知识库文章[825819](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;825819)。

-   **在支持高级 TCP/IP 筛选功能的系统上启用此功能。**  

    可以启用高级 TCP/IP 筛选来阻塞所有未经请求的入站流量。有关如何配置 TCP/IP 筛选的其他信息，请参见 Microsoft 知识库文章 [309798](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;309798)。

-   **在受影响的系统上阻塞使用 IPSec 的受影响端口。**  

    使用 Internet 协议安全 (IPSec) 有助于确保网络通信的安全。有关 IPSec 以及如何应用筛选器的详细信息，请参见 Microsoft 知识库文章 [313190](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;313190) 和[813878。](http://support.microsoft.com/?id=813878)

#### RPC 运行时库漏洞 - CAN-2003-0813 的常见问题解答：

**What is the scope of the 漏洞 ?**  
此漏洞是一个[争用情况](http://go.microsoft.com/fwlink/?linkid=21142)漏洞。如果攻击者成功地利用了此漏洞，即可在远程完全控制受影响的系统，包括安装程序、查看数据、更改数据、删除数据、或创建具有完全权限的新帐户。但是，争用情况是不可预测的。因此，在最可能的攻击方案中，此问题是一个[拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142)漏洞。

**此漏洞因何而起？**  
在 RPC 运行时库处理特制的邮件时，就会出现[争用情况](http://go.microsoft.com/fwlink/?linkid=21142)。

**什么是 RPC 运行时库？**  
默认情况下，RPC 运行时库安装在所有受影响的系统上。RPC 运行时库为应用程序开发人员提供通信服务、目录服务和安全服务等服务。有关 RPC 运行时库的更多信息，请访问以下 [Microsoft Developer Network (MSDN) Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/rpc/rpc/developing_32_bit_windows_applications.asp)。

**RPC 运行时库存在什么问题？**  
如果在指定时间内两个独立的操作系统线程都尝试处理某些特制邮件，则 RPC 运行时库就会出现此漏洞。该事件被看作是争用情况，因为它取决于两个线程的相对计时。此争用情况可能导致 RPC 运行时库不正确地修改内部数据结构。因此，受影响的系统可能遇到不可预测的情况。

**什么是争用情况？**  
[争用情况](http://go.microsoft.com/fwlink/?linkid=21142)取决于软件和多线程操作系统中事件的相对计时。很难经常利用它们重复执行任意代码。有关争用情况的更多信息，请访问以下[MSDN Library Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/cpguide/html/cpconmanagedthreadingbestpractices.asp)。有关争用情况的更一般的定义，请访问此 。

**这种争用情况为什么会导致漏洞？**  
这种争用情况可能创造一个环境，在该环境中一系列专门定时的请求可导致 RPC 运行时库执行不可预测的操作。但是，由于每次利用漏洞时，导致这种争用情况的具体条件都会发生变化，因此攻击者利用此漏洞就很困难。

**攻击者可能利用此漏洞执行什么操作？**  
此漏洞允许远程执行代码。如果攻击者成功地利用了此漏洞，即可完全控制受影响的系统，包括安装程序、查看数据、更改数据、删除数据，或创建具有完全权限的新帐户。然而，争用情况是不可预测的。因此，在最有可能的攻击方案中，此问题是一个[拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142) 漏洞。

**哪些人可能利用此漏洞？**  
任何可向受影响的系统发送一系列特制邮件的匿名用户都可以尝试利用此漏洞。默认情况下，在受影响的系统上此功能已被启用。因此，任何能够与受影响的系统建立连接的用户都可以尝试利用此漏洞。

**攻击者会如何利用此漏洞？**  
攻击者可以通过创建一系列特制的网络邮件，并将这些邮件发送到受影响的系统，来利用此漏洞。然后这些邮件就可以使受影响的系统执行代码。

攻击者也可以通过其他媒介访问受影响的组件。例如，攻击者可以通过交互方式登录到系统，或使用其他程序将参数传递给易受攻击的组件（在本地或远程）。

**此更新能做什么？**  
此更新可通过修改 RPC 运行时库对正在用于处理特制邮件的线程进行同步的方式来消除漏洞。

#### RPCSS 服务漏洞 - CAN-2004-0116:

[RPCSS](http://go.microsoft.com/fwlink/?linkid=21142) 服务中存在拒绝服务漏洞。如果将特制的邮件发送到 RPCSS 服务，该服务就可能无法回收被释放的内存，这一行为可能导致拒绝服务。

#### RPCSS 服务漏洞的缓解因素：

-   采用防火墙最佳做法和标准的默认防火墙配置，有助于保护网络免受源自企业防线外部的攻击。按照最佳做法，应使连接到 Internet 的系统所暴露的端口数尽可能少。
-   Windows NT 4.0 is not affected by this 漏洞 .

#### RPCSS 服务漏洞的变通办法：

Microsoft 已测试过以下变通办法。虽然这些变通办法不会从根本上消除漏洞，但它们有助于阻塞已知的攻击媒介。如果某种变通办法会导致功能下降，将在下面进行说明。

上面列出的用于 **RPC 运行时库漏洞 - CAN-2003-0813** 的变通办法也适用于此漏洞。此外，还可应用以下变通办法：

-   **禁用所有受影响的系统上的 DCOM。**  

    如果一个系统是网络的一部分，则DCOM 网络协议将启用该系统上的 COM 对象，以便与其他系统上的 COM 对象进行通信。可以对特定系统禁用 DCOM，以帮助防范他人利用此漏洞发动的攻击。但这将使该计算机上的对象无法与其他计算机上的对象通信。

    有关如何禁用 DCOM 的更多信息，请参见 Microsoft 知识库文章[825750](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;825750)。

    如果安装了 COM Internet 服务 (CIS) 或 RPC over HTTP，则 Microsoft 还建议您禁用转发到 DCOM。有关更多信息，请参见 Microsoft 知识库文章 [826382](http://support.microsoft.com/default.aspx?kbid=826382)。

    **注意** 在 Windows 2000 上，此方法仅适用于运行 Service Pack 3 或更高版本的系统。使用 Service Pack 2 或更低版本的客户应升级到更高版本的 Service Pack 或使用某种其他变通办法。

    **变通办法的影响:** 如果禁用远程系统上的 DCOM，则以后将无法通过远程访问该系统来重新启用 DCOM。要重新启用 DCOM，必须亲手操作该系统。

#### RPCSS 服务漏洞的常见问题解答：

**此漏洞的影响范围有多大？**  
这是一个[拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142)漏洞。成功利用此漏洞的攻击者必须向 RPCSS 发送特制的邮件，这些消息邮件可导致 RPCSS 服务停止响应并使受影响的系统自动重新启动。

Note that the denial of 服务漏洞 would not allow attackers to execute code or elevate their privileges, but it could cause the affected system to stop accepting requests.

**此漏洞因何而起？**  
在某些情况下，RPCSS 服务检查邮件输入所使用的进程会引发此漏洞。

**什么是 DCOM？**  
分布式组件对象模型 (DCOM) 是一种能够使软件组件通过网络直接进行通信的协议。DCOM 以前叫做“网络 OLE”，它能够跨越包括 Internet 协议（如 HTTP）在内的多种网络传输使用。有关 DCOM 的更多信息，请访问以下[Web 站点](http://www.microsoft.com/com/tech/dcom.asp)。

**RPCSS 服务存在什么问题？**  
在 DCOM 被激活的情况下，RPCSS 服务中的漏洞可导致受影响的系统由于处理特制邮件的方式不正确而失败。这种特定失败将影响用于 DCOM 激活的基本 RPCSS 服务。RPSCSS 服务侦听 UDP 端口 135、137、138 和 445 以及 TCP 端口 135、139、445 和 593。此外，如果启用了 CIS 或 RPC over HTTP，则 DCOM 还可侦听端口 80 和 443。

通过发送特制的 RPC 邮件，攻击者可以使远程系统上的 RPCSS 服务出现拒绝服务的故障。

**攻击者可能利用此漏洞执行什么操作？**  
如果攻击者成功地利用了此漏洞，可使 RPCSS 服务停止响应，并使受影响的系统自动重新启动。在 Windows NT 4.0 上，如果攻击者成功地利用了此漏洞，可使 RPCSS 服务停止响应。但是，这种现象不会导致受影响的系统自动重新启动。您必须手动重新启动受影响的 Windows NT 4.0 系统。

**哪些人可能利用此漏洞？**  
任何可向受影响的系统发送特制 RPC 邮件的匿名用户均可尝试利用此漏洞。

**攻击者会如何利用此漏洞？**  
要利用此漏洞，攻击者必须通过受影响的 TCP/UDP 端口向受影响的系统发送特制的 RPC 邮件。. 如果受影响的系统接收此类邮件，将导致 RPCSS 服务停止响应，并使受影响的系统自动重新启动。

攻击者也可以通过其他媒介访问受影响的组件。例如，攻击者可以通过交互方式登录到系统，或使用其他程序将参数传递给易受攻击的组件（在本地或远程）。

**此更新能做什么？**  
此更新可以修改 RPCSS 服务对收到的信息进行验证的方式，从而消除漏洞。

#### COM Internet 服务 (CIS) – RPC over HTTP 漏洞 - CAN-2003-0807：

CIS 和 RPC over HTTP 代理组件中存在[拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142)漏洞。当通过它们将转发请求传送到后端系统时，攻击者可使用特制的邮件对该请求作出回复，该邮件将使受影响的组件停止接受以后的请求。

#### COM Internet 服务 (CIS) 和 RPC over HTTP 漏洞的缓解因素：

默认情况下，受影响的操作系统都不容易受到攻击。所有受影响的操作系统都要求管理员启用受影响的组件或启用易受攻击的配置。有关如何产生易受攻击的配置的更多信息，请参见“常见问题解答”部分。

#### COM Internet 服务 (CIS) 和 RPC over HTTP 漏洞的变通办法：

Microsoft 已测试过以下变通办法。虽然这些变通办法不会从根本上消除漏洞，但它们有助于阻塞已知的攻击媒介。如果某种变通办法会导致功能下降，将在下面进行说明。

上面列出的用于 **RPC 运行时库漏洞 - CAN-2003-0813** 的变通办法也适用于此漏洞。此外，还可应用以下变通办法：

-   **如果已在受影响的系统上手动启用了 CIS 和 RPC over HTTP，则将禁止转发到不可信源。**  
    -   在 Windows NT 4.0 或 Windows 2000 上，如果管理员已经安装并启用了通过 CIS 转发到不可信服务器的功能，请验证 CIS 和 RPC over HTTP 是否被配置为仅允许转发到可信服务器。
    -   在 Windows Server 2003 上，如果管理员已配置了 RPC over HTTP，请确保 RPC over HTTP 没有以 IIS 5 兼容模式运行。默认模式 IIS 6.0 中不包含此漏洞。因此，默认模式就是首选配置。有关部署建议和配置设置的更多信息，请访问以下 [MSDN Library Web 站点](http://msdn.microsoft.com/library/zh-cn/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

        **注意** Microsoft 还建议管理员禁用转发到 DCOM 功能。有关更多信息，请参见 Microsoft 知识库文章 [826382](http://support.microsoft.com/default.aspx?kbid=826382)。

-   **如果不需要 CIS 或 RPC over HTTP，请在受影响系统上禁止此项功能。**  
    -   有关如何禁用 CIS 的信息，请参见 Microsoft 知识库文章 [825819](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;825819)。
    -   有关 RPC over HTTP 的信息，请访问以下 [MSDN Library Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/rpc/rpc/rpc_over_http_security.asp)。

#### COM Internet 服务 (CIS) 和 RPC Over HTTP 漏洞的常见问题解答：

**此漏洞的影响范围有多大？**  
这是一个 [拒绝服务](http://go.microsoft.com/fwlink/?linkid=21142)漏洞。如果攻击者成功地利用了此漏洞，可使 COM Internet 服务或 RPC over HTTP 组件停止接受连接，并使受影响的系统停止响应。管理员需要手动重新启动 Internet 信息服务 (IIS) 才能恢复正常操作。

**此漏洞因何而起？**  
在某些情况下，受影响的组件验证邮件输入所使用的进程会引发此漏洞。

**什么是 COM Internet 服务 (CIS) 和 RPC over HTTP？**  
RPC over HTTP 版本 1 (v1)（Windows NT 4.0、Windows 2000）和 v2 (Windows Server 2003) 允许 RPC 通过 TCP 端口 80 和 443（仅限 v2）执行操作，以便客户端和服务器能够通过大多数代理服务器和防火墙进行通信。COM Internet 服务 (CIS) 允许 DCOM 使用“HTTP 上的 RPC”在 DCOM 客户机和 DCOM 服务器之间通信。如果将 Windows Server 2003 设置为 IIS 5 兼容模式，则 Windows Server 2003 可以配置为支持 RPC over HTTP v1。IIS 6.0 模式使用 RPC over HTTP v2。IIS 6.0 模式不包含此漏洞。因此，IIS 6.0 模式是首选配置。有关部署建议和配置设置的更多信息，请访问以下 [MSDN Library Web 站点](http://msdn.microsoft.com/library/zh-cn/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

有关 Windows Server 2003 上的 RPC over HTTP 的更多信息，请访问以下 [MSDN Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/rpc/rpc/remote_procedure_calls_using_rpc_over_http.asp)。
有关 CIS 的更多信息，请访问以下 [MSDN Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/dndcom/html/cis.asp)。

**如何知道是否已经安装了 CIS 或 RPC over HTTP？**  
要确定服务器上是否已经安装了 CIS 或 RPC over HTTP，请根据所使用的操作系统采用以下方法之一：

-   在运行安装了 Windows NT Option Pack 的 Windows NT 4.0 的系统上：

    在所有的分区上搜索"**rpcproxy.dll**" 。如果在服务器上找到了 rpcproxy.dll 文件，则很可能已安装了 CIS。

-   在运行 Windows 2000 或 Windows Server 2003 的系统上：

    在**“控制面板”**中，双击 **“添加/删除程序”**，然后双击 **“添加/删除 Windows 组件”**。

    Windows 组件向导启动。

    单击 **“网络服务”**，然后单击**“详细信息”**。

    如果此时已选中**“COM Internet 服务代理”** （对于Windows 2000 Server）或**“RPC over HTTP 代理”** （对于 Windows Server 2003）复选框，则表明服务器上启用了 CIS 或 RPC over HTTP 支持。

    要搜索系统上的特定文件，请依次单击**“开始”**, 单击 **“搜索”**, 单击 **“文件或文件夹”**, 然后键入要搜索的文件名。搜索过程可能需要几分钟，具体取决于您的硬盘大小。

**攻击者可能利用此漏洞执行什么操作？**  
如果攻击者成功地利用了此拒绝服务漏洞，可使受影响的组件停止响应。

**哪些人可能利用此漏洞？**  
在 Windows NT 4.0 和 Windows 2000 上，通过受影响的组件将请求转发到后端系统时，匿名攻击者可以使用特制的邮件对该请求作出回复，该邮件可使受影响的组件停止接受以后的请求。

在 Windows Server 2003 上，攻击者还必须提供有效的登录凭据。

**攻击者会如何利用此漏洞？**  
攻击者可以通过以下方式利用此漏洞：

-   如果攻击者控制了配置为通过 CIS 或 RPC over HTTP 接收通信量的系统，则可以对来自CIS 或 RPC over HTTP 的请求创建一个可以利用此漏洞的恶意响应。
-   攻击者也可以通过在网络上本地侦听来自启用了 CIS 或 RPC over HTTP 代理的系统的通信量来尝试利用此漏洞。攻击者随后可以代表 CIS 或 RPC over HTTP 正在尝试与其通信的系统对转发的请求发送一个特制的恶意响应。

如果系统收到任何一种类型的特制邮件，都会使受影响的组件停止响应。

攻击者也可以通过其他媒介访问受影响的组件。例如，攻击者可以通过交互方式登录到系统，或使用其他程序将参数传递给易受攻击的组件（在本地或远程）。

**受此漏洞威胁最大的系统是哪些？**  
默认情况下，在任何受影响的系统上都不会启用受影响的组件。

但是，如果已经安装了 Windows NT 4.0 Option Pack，则受影响的组件就会被安装在 Windows NT 4.0 Server 和 Windows NT 4.0 终端服务器版上。这是默认行为。如果管理员不执行 Microsoft 知识库文章 [282261](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;282261)中描述的步骤，也就不会启用受影响的组件。

默认情况下，受影响的组件不会安装在 Windows 2000 或 Windows Server 2003 上。管理员必须手动为系统安装受影响的组件，以使该系统处于此漏洞的风险下。

在这两种情况下，管理员都必须手动配置受影响的组件，以便将请求转发到另一个系统，使受影响组件变得容易遭受攻击。

在 Windows Server 2003 上，由于 Internet 信息服务的默认配置不易受到攻击，因此即使安装了受影响的组件，影响也会大大减小。只有在启用了 IIS 5.0 兼容模式的情况下，Windows Server 2003 才容易受到攻击。Microsoft 建议不要启用 IIS 5.0 兼容模式以用于 RPC over HTTP。有关部署建议的更多信息，请访问以下 [MSDN Library Web 站点](http://msdn.microsoft.com/library/zh-cn/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

Windows NT 4.0 Workstation 和 Windows XP 不支持安装受影响的组件。因此，这些操作系统不受此漏洞的影响。

**此更新需要手动步骤吗？**  
如果系统是运行 CIS 的 Windows NT 4.0，则需要手动步骤。Windows NT 4.0 要求管理员手动执行 Microsoft 知识库文章 [282261](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;282261)中描述的步骤，以启用 CIS，包括指定 rpcproxy.dll 文件的物理位置。要帮助防范他人利用此漏洞发动攻击，管理员必须手动将 rpcproxy.dll 文件的更新版本复制到首次使用该文件启用 CIS 的位置，因为此更新无法通过编程方式确定此位置。

**此更新能做什么？**  
更新可以通过修改受影响的组件对接收的信息进行验证的方式来解决此漏洞。

#### 对象标识漏洞 - CAN-2004-0124：

创建对象标识的方式中存在信息泄露漏洞。此漏洞允许攻击者启用能够打开网络通信端口的应用程序。虽然此漏洞不会直接使攻击者危及系统安全，但可利用此漏洞通过意外的端口进行网络通信。

#### 对象标识漏洞的缓解因素：

采用防火墙最佳做法和标准的默认防火墙配置，有助于保护网络免受源自企业防线外部的远程攻击。按照最佳做法，应使连接到 Internet 的系统所暴露的端口数尽可能少。

#### 对象标识漏洞的变通办法：

上面列出的用于 **RPC 运行时库漏洞 - CAN-2003-0813**的变通办法也适用于此漏洞。

#### 对象标识漏洞的常见问题解答：

**此漏洞的影响范围有多大？**  
这是一个信息泄露漏洞。如果攻击者成功地利用了此漏洞，即可启用能够打开网络通信端口的应用程序，包括并非专门用于网络通信的应用程序。此漏洞不会直接使攻击者危及系统安全。但是，可利用此漏洞通过意外的通信端口进行网络通信。

**此漏洞因何而起？**  
The way that COM object identifiers are created.

**What is a COM object identifier?**  
每个应用程序都有一个对象标识符。对于操作系统而言，对象标识符是标识应用程序的唯一编号。此漏洞可使攻击者获知对象标识符。随后，攻击者就可以强制某一应用程序打开网络通信端口，并指示该应用程序接受入站连接请求。有关如何使用对象标识的更多信息，请访问以下 [Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/dnanchor/html/componentobjectmodelanchor.asp)。

**攻击者可能利用此漏洞执行什么操作？**  
如果攻击者成功地利用了此漏洞，即可强制某一应用程序接受入站连接请求。此漏洞并不会直接使攻击者危及系统安全。但是，可以利用此漏洞通过意外的通信端口进行网络通信。

**哪些人可能利用此漏洞？**  
任何可向受影响系统发送特制的 RPC 邮件的匿名用户均可利用此漏洞。

**攻击者会如何利用此漏洞？**  
要利用此漏洞，攻击者必须通过受影响的 TCP/UDP 端口向受影响系统发送特制的 RPC 邮件。 [Web 站点](http://go.microsoft.com/fwlink/?linkid=21312)。

**Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 是否会受此漏洞的严重影响？**  
不。虽然这些操作系统可能包含受影响的组件，但是此漏洞并不严重。有关严重等级的更多信息，请访问以下 [Web site](http://go.microsoft.com/fwlink/?linkid=21140)。

**此更新能做什么？**  
此更新可以修改创建对象标识的方式。这种新行为使潜在的攻击者更加难以获知对象标识符。

安全更新信息
------------

**安装平台和先决条件：**  

有关用于您的平台的特定安全更新的信息，请单击相应链接：

#### Windows Server 2003（所有版本）

**先决条件**  
此安全更新要求 Windows Server 2003 的已发布版本。

**包括在将来的哪些 Service Pack 中：**  
针对这些问题的更新将包括在 Windows Server 2003 Service Pack 1 中。

**安装信息**  

**/help** 显示命令行选项

**安装模式**  

**/quiet????** 安静模式（无用户交互或显示）

**/passive** 无人参与模式（只显示进度栏）

**/uninstall?** 卸载程序包package

**重新启动选项**  

**/norestart** 安装完成后不重新启动

**/forcerestart** 安装完成后重新启动

**特殊选项**  

**/l** 列出已安装的 Windows 修复程序或更新程序包

**/o** 不经提示而改写 OEM 文件

**/n** 不备份卸载所需的文件

**/f** 在计算机关机时强制关闭其他程序 down

**注意** 可以将这些开关组合到一个命令中。为了向后兼容，此安全更新还支持以前版本的安装实用工具所使用的安装开关。有关受支持的安装开关的更多信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)。

**部署信息**  

对于 Windows Server 2003，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令：

**Windowsserver2003-kb828741-x86-enu /passive /quiet**  

对于 Windows Server 2003，要安装此安全更新而不强制系统重新启动，请在命令提示符下使用以下命令：

**Windowsserver2003-kb828741-x86-enu /norestart**  

有关如何使用软件更新服务部署此安全更新的更多信息，请访问[软件更新服务 Web 站点](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

应用此安全更新后，必须重新启动系统。

**删除信息**  

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB835732$\\Spuninst 文件夹中。Spuninst.exe 实用工具支持以下安装开关：

**/?**: 显示安装开关列表

**/u**: 使用无人参与模式

**/f**: 关闭计算机时强制其他程序退出

**/z**: 安装完成时不重新启动

**/q**: 使用安静模式（没有用户交互）

**文件信息**  

此更新的英文版具有下表所列的（或更新的）文件属性。这些文件的日期和时间按照协调通用时间 (UTC) 列出。当您查看文件信息时，它将转换为本地时间。要了解 UTC 和本地时间之间的时差，可使用“控制面板”的“日期和时间”工具中的**“时区”**选项卡。

对于 Windows Server 2003 企业版、Windows Server 2003 标准版、Windows Server 2003 Web 版和 Windows Server 2003 数据中心版：

```
Date Time Version Size File name Folder
------------------------------------------------------------------------
16-Mar-2004 03:09 2001.12.4720.130 263,680 Catsrv.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 587,264 Catsrvut.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 98,304 Clbcatex.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 493,056 Clbcatq.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 58,368 Colbact.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.139 189,440 Comadmin.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 1,202,176 Comsvcs.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 566,272 Comuid.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 226,816 Es.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 443,904 Msdtcprx.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 972,288 Msdtctm.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 160,768 Msdtcuiu.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 76,288 Mtxclu.dll RTMGDR
16-Mar-2004 03:09 2001.12.4720.130 108,032 Mtxoci.dll RTMGDR
16-Mar-2004 03:09 5.2.3790.138 1,189,376 Ole32.dll RTMGDR
16-Mar-2004 03:09 5.2.3790.137 26,112 Rpcproxy.dll RTMGDR
16-Mar-2004 03:09 5.2.3790.137 660,992 Rpcrt4.dll RTMGDR
16-Mar-2004 03:09 5.2.3790.132 294,400 Rpcss.dll RTMGDR
16-Mar-2004 03:17 2001.12.4720.130 263,680 Catsrv.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 587,264 Catsrvut.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 98,304 Clbcatex.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 493,056 Clbcatq.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 58,368 Colbact.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.139 189,440 Comadmin.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 1,202,176 Comsvcs.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 566,272 Comuid.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 226,816 Es.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 443,904 Msdtcprx.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 972,288 Msdtctm.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 160,768 Msdtcuiu.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 76,288 Mtxclu.dll RTMQFE
16-Mar-2004 03:17 2001.12.4720.130 108,032 Mtxoci.dll RTMQFE
16-Mar-2004 03:17 5.2.3790.139 1,188,352 Ole32.dll RTMQFE
16-Mar-2004 03:17 5.2.3790.141 26,112 Rpcproxy.dll RTMQFE
16-Mar-2004 03:17 5.2.3790.141 659,968 Rpcrt4.dll RTMQFE
16-Mar-2004 03:17 5.2.3790.142 293,888 Rpcss.dll RTMQFE
```

对于 Windows Server 2003 64 位企业版和 Windows Server 2003 64 位数据中心版：

```
Date Time Version Size File name Platform Folder
-------------------------------------------------------------------------------
31-Mar-2004 03:29 2001.12.4720.130 641,024 Catsrv.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,567,744 Catsrvut.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 263,680 Clbcatex.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,294,336 Clbcatq.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 179,712 Colbact.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.139 412,160 Comadmin.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 3,127,296 Comsvcs.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,873,408 Comuid.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 653,312 Es.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,301,504 Msdtcprx.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 3,166,208 Msdtctm.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 462,848 Msdtcuiu.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 203,776 Mtxclu.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 315,904 Mtxoci.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.146 3,567,616 Ole32.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.137 73,216 Rpcproxy.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.137 2,140,160 Rpcrt4.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.146 687,104 Rpcss.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 263,680 Wcatsrv.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 587,264 Wcatsrvut.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 98,304 Wclbcatex.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 493,056 Wclbcatq.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 58,368 Wcolbact.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.139 189,440 Wcomadmin.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 1,202,176 Wcomsvcs.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 226,816 Wes.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 443,904 Wmsdtcprx.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 160,768 Wmsdtcuiu.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 76,288 Wmtxclu.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 108,032 Wmtxoci.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.146 1,189,376 Wole32.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.137 26,112 Wrpcproxy.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.137 542,208 Wrpcrt4.dll X86 RTMGDR\WOW
31-Mar-2004 03:25 2001.12.4720.130 641,024 Catsrv.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,567,744 Catsrvut.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 263,680 Clbcatex.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,294,336 Clbcatq.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 179,712 Colbact.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.139 412,160 Comadmin.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 3,127,296 Comsvcs.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,873,408 Comuid.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 653,312 Es.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,301,504 Msdtcprx.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 3,166,208 Msdtctm.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 462,848 Msdtcuiu.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 203,776 Mtxclu.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 315,904 Mtxoci.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.146 3,565,056 Ole32.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.141 73,216 Rpcproxy.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.141 2,150,400 Rpcrt4.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.146 685,568 Rpcss.dll IA64 RTMQFE
31-Mar-2004 03:26 2001.12.4720.130 263,680 Wcatsrv.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 587,264 Wcatsrvut.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 98,304 Wclbcatex.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 493,056 Wclbcatq.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 58,368 Wcolbact.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.139 189,440 Wcomadmin.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 1,202,176 Wcomsvcs.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 226,816 Wes.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 443,904 Wmsdtcprx.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 160,768 Wmsdtcuiu.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 76,288 Wmtxclu.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 108,032 Wmtxoci.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.146 1,188,352 Wole32.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.141 26,112 Wrpcproxy.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.141 544,256 Wrpcrt4.dll X86 RTMQFE\WOW
```

**注意** 在 Windows Server 2003 或 Windows XP 64-Bit Edition Version 2003 上安装此安全更新时，安装程序会检查系统上正在更新的文件是否曾被 Microsoft 修复程序更新过。如果以前安装的修复程序已更新过其中的某个文件，则安装程序会将 RTMQFE 文件复制到您的系统。否则，安装程序会将 RTMGDR 文件复制到您的系统。有关更多信息，请参见 Microsoft 知识库文章 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**验证更新安装**  

要验证受影响的系统是否安装的了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具，此工具允许管理员扫描本地和远程系统，以查找丢失的安全更新和常见安全错误配置。有关 MBSA 的更多信息，请访问[Microsoft 基准安全分析器 Web 站点](http://go.microsoft.com/fwlink/?linkid=21134)。

通过查看下面的注册表项，还可以验证此安全更新安装的文件：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB828741\\Filelist

**注意**如果管理员或 OEM 将 828741 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows XP（所有版本）

**注意** 对于 Windows XP 64-Bit Edition Version 2003，此安全更新与 Windows Server 2003 64 位版本的安全更新相同。.

**先决条件**  
此安全更新要求 Windows XP 或 Windows XP Service Pack 1 (SP1) 的已发布版本。有关其他信息，请参见 Microsoft 知识库文章 [322389](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;322389)。

**包括在将来的哪些 Service Pack 中：**  
针对这些问题的更新将包括在 Windows XP Service Pack 2 中。

**安装信息**  

**/help** 显示命令行选项

**安装模式**  

**/quiet????** 安静模式（无用户交互或显示）

**/passive** 无人参与模式（只显示进度栏）

**/uninstall?** 卸载程序包package

**重新启动选项**  

**/norestart** 安装完成后不重新启动

**/forcerestart** 安装完成后重新启动

**特殊选项**  

**/l** 列出已安装的 Windows 修复程序或更新程序包

**/o** 不经提示而改写 OEM 文件

**/n** 不备份卸载所需的文件

**/f** 在计算机关机时强制关闭其他程序 down

**注意** ：可以将这些开关组合到一个命令中。为了向后兼容，此安全更新还支持以前版本的安装实用工具所使用的安装开关。有关受支持的安装开关的更多信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)。

**部署信息**  

对于 Windows XP，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令：

**Windowsxp-kb828741-x86-enu /passive /quiet**  

对于 Windows XP，要安装此安全更新而不强制系统重新启动，请在命令提示符下使用以下命令：

**Windowsxp-kb828741-x86-enu /norestart**  

有关如何使用软件更新服务部署此安全更新的更多信息，请访问软件更新服务 Web 站点。

**重新启动要求**  

应用此安全更新后，必须重新启动系统。

**删除信息**  

要删除此安全更新，请使用"控制面板"中的"添加或删除程序"工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB835732$\\Spuninst 文件夹中。Spuninst.exe 实用工具支持以下安装开关：

**/?**: 显示安装开关列表

**/u**: 使用无人参与模式

**/f**: 关闭计算机时强制其他程序退出

**/z**: 安装完成时不重新启动

**/q**: 使用安静模式（没有用户交互）

**文件信息**  

此更新的英文版具有下表所列的（或更新的）文件属性。这些文件的日期和时间按照协调通用时间 (UTC) 列出。当您查看文件信息时，它将转换为本地时间。要了解 UTC 和本地时间之间的时差，可使用"控制面板"的"日期和时间"工具中的"时区"选项卡。

对于 Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

```
Date Time Version Size File name Folder
-----------------------------------------------------------------------
06-Mar-2004 02:04 2001.12.4414.53 225,280 Catsrv.dll (pre-sp1)
06-Mar-2004 02:04 2001.12.4414.53 596,480 Catsrvut.dll (pre-sp1)
06-Mar-2004 02:04 2001.12.4414.53 110,080 Clbcatex.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 499,712 Clbcatq.dll (pre-sp1)
06-Mar-2004 02:04 2001.12.4414.53 64,512 Colbact.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 187,904 Comadmin.dll (pre-sp1)
17-Feb-2004 18:49 2001.12.4414.53 8,192 Comrepl.exe (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 1,177,088 Comsvcs.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 499,200 Comuid.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 226,816 Es.dll (pre-sp1)
17-Feb-2004 18:50 2001.12.4414.53 6,656 Migregdb.exe (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 365,568 Msdtcprx.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 977,920 Msdtctm.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 150,528 Msdtcuiu.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 64,512 Mtxclu.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 82,432 Mtxoci.dll (pre-sp1)
06-Mar-2004 02:05 5.1.2600.136 1,105,408 Ole32.dll (pre-sp1)
06-Mar-2004 02:05 5.1.2600.135 442,880 Rpcrt4.dll (pre-sp1)
06-Mar-2004 02:05 5.1.2600.135 214,528 Rpcss.dll (pre-sp1)
06-Mar-2004 02:05 2001.12.4414.53 97,280 Txflog.dll (pre-sp1)
06-Mar-2004 02:16 2001.12.4414.53 225,280 Catsrv.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 594,944 Catsrvut.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 110,080 Clbcatex.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 499,712 Clbcatq.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 64,512 Colbact.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 187,904 Comadmin.dll (with sp1)
17-Feb-2004 18:49 2001.12.4414.53 8,192 Comrepl.exe (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 1,194,496 Comsvcs.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 499,200 Comuid.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 226,816 Es.dll (with sp1)
17-Feb-2004 18:50 2001.12.4414.53 6,656 Migregdb.exe (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 367,616 Msdtcprx.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 977,920 Msdtctm.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 150,528 Msdtcuiu.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 64,512 Mtxclu.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 82,432 Mtxoci.dll (with sp1)
06-Mar-2004 02:16 5.1.2600.1362 1,183,744 Ole32.dll (with sp1)
06-Mar-2004 02:16 5.1.2600.1361 535,552 Rpcrt4.dll (with sp1)
06-Mar-2004 02:16 5.1.2600.1361 263,680 Rpcss.dll (with sp1)
06-Mar-2004 02:16 2001.12.4414.53 97,280 Txflog.dll (with sp1)
```

Windows XP 64-Bit Edition Service Pack 1:

```
Date Time Version Size File name Platform
---------------------------------------------------------------------
06-Mar-2004 02:07 2001.12.4414.53 695,808 Catsrv.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 2,127,360 Catsrvut.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 360,960 Clbcatex.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 1,554,432 Clbcatq.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 204,288 Colbact.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 478,720 Comadmin.dll IA64
09-Jan-2004 22:50 2001.12.4414.53 20,992 Comrepl.exe IA64
06-Mar-2004 02:07 2001.12.4414.53 3,591,168 Comsvcs.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 1,817,600 Comuid.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 740,864 Es.dll IA64
09-Jan-2004 22:51 2001.12.4414.53 12,800 Migregdb.exe IA64
06-Mar-2004 02:07 2001.12.4414.53 1,509,888 Msdtcprx.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 3,484,160 Msdtctm.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 513,024 Msdtcuiu.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 194,048 Mtxclu.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 286,720 Mtxoci.dll IA64
06-Mar-2004 02:07 5.1.2600.1362 4,339,200 Ole32.dll IA64
06-Mar-2004 02:07 5.1.2600.1361 2,317,824 Rpcrt4.dll IA64
06-Mar-2004 02:07 5.1.2600.1361 780,288 Rpcss.dll IA64
06-Mar-2004 02:07 2001.12.4414.53 345,088 Txflog.dll IA64
06-Mar-2004 02:16 2001.12.4414.53 225,280 Wcatsrv.dll X86
06-Mar-2004 02:16 2001.12.4414.53 594,944 Wcatsrvut.dll X86
06-Mar-2004 02:16 2001.12.4414.53 110,080 Wclbcatex.dll X86
06-Mar-2004 02:16 2001.12.4414.53 499,712 Wclbcatq.dll X86
06-Mar-2004 02:16 2001.12.4414.53 64,512 Wcolbact.dll X86
06-Mar-2004 02:16 2001.12.4414.53 187,904 Wcomadmin.dll X86
06-Mar-2004 02:16 2001.12.4414.53 1,194,496 Wcomsvcs.dll X86
06-Mar-2004 02:16 2001.12.4414.53 226,816 Wes.dll X86
06-Mar-2004 02:16 2001.12.4414.53 367,616 Wmsdtcprx.dll X86
06-Mar-2004 02:16 2001.12.4414.53 150,528 Wmsdtcuiu.dll X86
06-Mar-2004 02:16 2001.12.4414.53 64,512 Wmtxclu.dll X86
06-Mar-2004 02:16 2001.12.4414.53 82,432 Wmtxoci.dll X86
06-Mar-2004 02:16 5.1.2600.1362 1,183,744 Wole32.dll X86
06-Mar-2004 02:16 5.1.2600.1361 509,440 Wrpcrt4.dll X86
06-Mar-2004 02:16 2001.12.4414.53 97,280 Wtxflog.dll X86
```

Windows XP 64-Bit Edition Version 2003:

```
Date Time Version Size File name Platform Folder
------------------------------------------------------------------------------
31-Mar-2004 03:29 2001.12.4720.130 641,024 Catsrv.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,567,744 Catsrvut.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 263,680 Clbcatex.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,294,336 Clbcatq.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 179,712 Colbact.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.139 412,160 Comadmin.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 3,127,296 Comsvcs.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,873,408 Comuid.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 653,312 Es.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 1,301,504 Msdtcprx.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 3,166,208 Msdtctm.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 462,848 Msdtcuiu.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 203,776 Mtxclu.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 315,904 Mtxoci.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.146 3,567,616 Ole32.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.137 73,216 Rpcproxy.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.137 2,140,160 Rpcrt4.dll IA64 RTMGDR
31-Mar-2004 03:29 5.2.3790.146 687,104 Rpcss.dll IA64 RTMGDR
31-Mar-2004 03:29 2001.12.4720.130 263,680 Wcatsrv.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 587,264 Wcatsrvut.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 98,304 Wclbcatex.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 493,056 Wclbcatq.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 58,368 Wcolbact.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.139 189,440 Wcomadmin.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 1,202,176 Wcomsvcs.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 226,816 Wes.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 443,904 Wmsdtcprx.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 160,768 Wmsdtcuiu.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 76,288 Wmtxclu.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 2001.12.4720.130 108,032 Wmtxoci.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.146 1,189,376 Wole32.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.137 26,112 Wrpcproxy.dll X86 RTMGDR\WOW
31-Mar-2004 03:29 5.2.3790.137 542,208 Wrpcrt4.dll X86 RTMGDR\WOW
31-Mar-2004 03:25 2001.12.4720.130 641,024 Catsrv.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,567,744 Catsrvut.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 263,680 Clbcatex.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,294,336 Clbcatq.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 179,712 Colbact.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.139 412,160 Comadmin.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 3,127,296 Comsvcs.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,873,408 Comuid.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 653,312 Es.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 1,301,504 Msdtcprx.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 3,166,208 Msdtctm.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 462,848 Msdtcuiu.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 203,776 Mtxclu.dll IA64 RTMQFE
31-Mar-2004 03:25 2001.12.4720.130 315,904 Mtxoci.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.146 3,565,056 Ole32.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.141 73,216 Rpcproxy.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.141 2,150,400 Rpcrt4.dll IA64 RTMQFE
31-Mar-2004 03:25 5.2.3790.146 685,568 Rpcss.dll IA64 RTMQFE
31-Mar-2004 03:26 2001.12.4720.130 263,680 Wcatsrv.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 587,264 Wcatsrvut.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 98,304 Wclbcatex.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 493,056 Wclbcatq.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 58,368 Wcolbact.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.139 189,440 Wcomadmin.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 1,202,176 Wcomsvcs.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 226,816 Wes.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 443,904 Wmsdtcprx.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 160,768 Wmsdtcuiu.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 76,288 Wmtxclu.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 2001.12.4720.130 108,032 Wmtxoci.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.146 1,188,352 Wole32.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.141 26,112 Wrpcproxy.dll X86 RTMQFE\WOW
31-Mar-2004 03:26 5.2.3790.141 544,256 Wrpcrt4.dll X86 RTMQFE\WOW
```

**注意**：此安全更新的 Windows XP 和 Windows XP 64-Bit Edition Version 2003 版被打包为双模式程序包，该双模式程序包同时包含 Windows XP 原始版本和 Windows XP Service Pack 1 (SP1) 的文件。有关双模式程序包的更多信息，请参见 Microsoft 知识库文章 [328848](http://support.microsoft.com/default.aspx?kbid=328848)。

安装 Windows XP 64-Bit Edition Version 2003 安全更新时，安装程序会检查系统上正在更新的文件是否曾被 Microsoft 修复程序更新过。如果以前安装的修复程序已更新过其中的某个文件，则安装程序会将 RTMQFE 文件复制到您的系统。否则，安装程序会将 RTMGDR 文件复制到您的系统。有关更多信息，请参见 Microsoft 知识库文章 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**验证更新安装**  

要验证受影响的系统是否已经安装的了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具，此工具允许管理员扫描本地和远程系统，以查找丢失的安全更新和常见安全错误配置。有关 MBSA 的更多信息，请访问 [Microsoft 基准安全分析器 Web 站点](http://go.microsoft.com/fwlink/?linkid=21134)。

通过查看下面的注册表项，还可以验证此安全更新安装的文件：

对于 Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB828741\\Filelist

**注意** ：如果管理员或 OEM 将 828741 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows 2000 （所有版本）

**先决条件**  
对于 Windows 2000，此安全更新要求已经安装了 Service Pack 2 (SP2)、Service Pack 3 (SP3) 或 Service Pack 4 (SP4)。

已对上面列出的软件进行了测试，以确定这些版本是否受到影响。其他版本或者不再包括安全更新支持，或者可能不受影响。请访问 Microsoft Support Lifecycle Web 站点，确定产品和版本的支持周期。

有关如何获得最新 Service Pack 的更多信息，请参见 Microsoft 知识库文章 [260910](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;260910)。

**包括在将来的哪些 Service Pack 中：**  
针对这些问题的更新将包括在 Windows 2000 Service Pack 5 中。

**安装信息**  

**/help** 显示命令行选项

**安装模式**  

**/quiet**安静模式（无用户交互或显示）

**/passive** 无人参与模式（只显示进度栏）

**/uninstall?**卸载程序包package

**重新启动选项**  

**/norestart** 安装完成后不重新启动

**/forcerestart** 安装完成后重新启动

**特殊选项**  

**/l** 列出已安装的 Windows 修复程序或更新程序包

**/o** 不经提示而改写 OEM 文件

**/n** 不备份卸载所需的文件

**/f** 在计算机关机时强制关闭其他程序 down

**注意**：可以将这些开关组合到一个命令中。为了向后兼容，此安全更新还支持以前版本的安装实用工具所使用的安装开关。有关受支持的安装开关的更多信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)。

**部署信息**  

对于 Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令：

**Windows2000-kb828741-x86-enu /passive /quiet**  

对于 Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，要安装此安全更新而不强制系统重新启动，请在命令提示符下使用以下命令：

**Windows2000-kb828741-x86-enu /norestart**  

有关如何使用软件更新服务部署此安全更新的更多信息，请访问软件更新服务 Web 站点。

**重新启动要求**  

应用此安全更新后，必须重新启动系统。

**删除信息**  

要删除此安全更新，请使用"控制面板"中的"添加/删除程序"工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB835732$\\Spuninst 文件夹中。Spuninst.exe 实用工具支持以下安装开关：

**/?**: 显示安装开关列表

**/u**: 使用无人参与模式

**/f**: 关闭计算机时强制其他程序退出

**/z**: 安装完成时不重新启动

**/q**: 使用安静模式（没有用户交互）

**文件信息**  

此更新的英语版具有下表所列的（或更新的）文件属性。这些文件的日期和时间按照协调通用时间 (UTC) 列出。当您查看文件信息时，它将转换为本地时间。要了解 UTC 和本地时间之间的时差，可使用"控制面板"的"日期和时间"工具中的"时区"选项卡。

**注意**：在安装过程中，日期和时间信息可能会改变。应该使用版本、大小和文件名信息来确定文件的正确性。

对于 Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4：

```
Date Time Version Size File name
------------------------------------------------------------
11-Mar-2004 21:29 2000.2.3511.0 169,232 Catsrv.dll
11-Mar-2004 21:29 2000.2.3511.0 595,728 Catsrvut.dll
11-Mar-2004 21:29 2000.2.3511.0 97,040 Clbcatex.dll
11-Mar-2004 21:29 2000.2.3511.0 552,720 Clbcatq.dll
11-Mar-2004 21:29 2000.2.3511.0 41,744 Colbact.dll
11-Mar-2004 21:29 2000.2.3511.0 198,416 Comadmin.dll
11-Mar-2004 21:29 2000.2.3511.0 97,552 Comrepl.dll
11-Mar-2004 21:29 2000.2.3421.351 342,288 Comsetup.dll
11-Mar-2004 21:29 2000.2.3511.0 1,467,664 Comsvcs.dll
11-Mar-2004 21:29 2000.2.3511.0 625,936 Comuid.dll
19-Feb-2004 22:03 2000.2.3511.0 1,816,552 Dtcsetup.exe
11-Mar-2004 21:29 2000.2.3511.0 239,888 Es.dll
11-Mar-2004 21:29 2000.2.3511.0 96,016 Msdtclog.dll
11-Mar-2004 21:29 2000.2.3513.0 717,584 Msdtcprx.dll
11-Mar-2004 21:29 2000.2.3511.0 1,139,984 Msdtctm.dll
11-Mar-2004 21:29 2000.2.3511.0 153,872 Msdtcui.dll
19-Feb-2004 22:44 2000.2.3511.0 155,408 Mtstocom.exe
11-Mar-2004 21:29 2000.2.3511.0 52,496 Mtxclu.dll
11-Mar-2004 21:29 2000.2.3511.0 26,896 Mtxdm.dll
11-Mar-2004 21:29 2000.2.3511.0 35,600 Mtxlegih.dll
11-Mar-2004 21:29 2000.2.3513.0 120,592 Mtxoci.dll
11-Mar-2004 21:29 5.0.2195.6906 954,640 Ole32.dll
11-Mar-2004 21:29 5.0.2195.6904 16,656 Rpcproxy.dll
11-Mar-2004 21:29 5.0.2195.6904 449,808 Rpcrt4.dll
11-Mar-2004 21:29 5.0.2195.6906 211,728 Rpcss.dll
11-Mar-2004 21:29 2000.2.3511.0 398,608 Txfaux.dll
11-Mar-2004 21:29 2000.2.3511.0 18,704 Xolehlp.dll
```

**验证更新安装**  

要验证受影响的系统是否安装了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具，此工具允许管理员扫描本地和远程系统，以查找丢失的安全更新和常见安全错误配置。有关 MBSA 的更多信息，请访问 [Microsoft 基准安全分析器 Web 站点](http://go.microsoft.com/fwlink/?linkid=21134)。

通过查看下面的注册表项，还可以验证此安全更新安装的文件：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB828741\\Filelist

**注意**：如果管理员或 OEM 将 828741 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows NT 4.0 (所有版本)

**先决条件**  
此安全更新要求 Windows NT Workstation 4.0 Service Pack 6a (SP6a)、Windows NT Server 4.0 Service Pack 6a (SP6a) 或 Windows NT Server 4.0 终端服务器版 Service Pack 6 (SP6)。

已对上面列出的软件进行了测试，以确定这些版本是否受到影响。其他版本或者不再包括安全更新支持，或者可能不受影响。请访问下面的[Microsoft Support Lifecycle Web 站点](http://go.microsoft.com/fwlink/?linkid=21742) ，确定产品和版本的支持周期。

有关如何获得最新 Service Pack 的更多信息，请参见 Microsoft 知识库文章[152734](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;152734)。

**安装信息**  

此安全更新支持以下安装开关：

**/y**: 执行删除（仅与 /m 或 /q 一同使用）

**/f**: 关机过程中强制程序退出

**/n**: 不创建 Uninstall 文件夹

**/z**: 更新完成时不重新启动

**/q**: 使用不带用户界面的安静模式或无人参与模式（此开关是 /m 的超集）

**/m**: 使用带有用户界面的无人参与模式

**/l**: 列出已安装的修复程序

**/x**: 解压缩文件，但不运行安装程序

**注意** ：可以将这些开关组合到一个命令中。有关受支持的安装开关的更多信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)

**部署信息**  

对于 Windows NT Server 4.0，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令：

**Windowsnt4server-kb828741-x86-enu /q**  

对于 Windows NT Server 4.0 终端服务器版：

**Windowsnt4terminalserver-kb828741-x86-enu /q**  

对于 Windows NT Workstation 4.0：

**Windowsnt4workstation-kb828741-x86-enu /q**  

对于 Windows NT Server 4.0，要安装此安全更新而不强制系统重新启动，请在命令提示符下使用以下命令：

**Windowsnt4server-kb828741-x86-enu /z**  

对于 Windows NT Server 4.0 终端服务器版：

**Windowsnt4terminalserver-kb828741-x86-enu /z**  

对于 Windows NT Workstation 4.0：

**Windowsnt4workstation-kb828741-x86-enu /z**  

有关如何使用软件更新服务部署此安全更新的更多信息，请访问软件更新服务 Web 站点。

**重新启动要求**  

应用此安全更新后，必须重新启动系统。

**删除信息**  

要删除此安全更新，请使用"控制面板"中的"添加/删除程序"工具。

系统管理员可以使用 Hotfix.exe 实用工具删除此安全更新。此 Hotfix.exe 实用工具位于 %Windir%\\$NTUninstallKB835732$ 文件夹中。Hotfix.exe 实用工具支持以下安装开关：

**/y**: 执行删除（仅与 /m 或 /q 开关一起使用）

**/f**: 关机过程中强制程序退出

**/n**: 不创建 Uninstall 文件夹

**/z**: 安装完成时不重新启动

**/q**: 使用不带用户界面的安静模式或无人参与模式（此开关是 /m 的超集）

**/m**: 使用带有用户界面的无人参与模式

**/l**: 列出已安装的修复程序

**文件信息**  

此修复程序的英语版具有下表所列的（或更新的）文件属性。这些文件的日期和时间按照协调通用时间 (UTC) 列出。当您查看文件信息时，它将转换为本地时间。要了解 UTC 和本地时间之间的时差，可使用"控制面板"的"日期和时间"工具中的"时区"选项卡。

**注意**：在安装过程中，日期和时间信息可能会改变。应该使用版本、大小和文件名信息来确定文件的正确性。

对于 Windows NT Workstation 4.0 和 Windows NT Server 4.0：

```
Date Time Version Size File name
----------------------------------------------------------
25-Feb-2004 15:53 4.0.1381.7263 701,200 Ole32.dll
08-Jan-2004 11:37 4.0.1381.7255 21,264 Rpcproxy.dll
11-Aug-2003 14:29 4.0.1381.7230 345,872 Rpcrt4.dll
25-Feb-2004 15:53 4.0.1381.7263 122,128 Rpcss.exe
```

Windows NT Server 4.0 Terminal Server Edition:

```
Date Time Version Size File name
----------------------------------------------------------
25-Feb-2004 15:52 4.0.1381.33562 701,200 Ole32.dll
05-Dec-2003 17:51 4.0.1381.33559 21,264 Rpcproxy.dll
11-Aug-2003 15:14 4.0.1381.33551 345,360 Rpcrt4.dll
25-Feb-2004 15:52 4.0.1381.33562 124,176 Rpcss.exe
```

**验证更新安装**  

要验证受影响的系统是否安装的了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具，此工具允许管理员扫描本地和远程系统，以查找丢失的安全更新和常见安全错误配置。有关 MBSA 的更多信息，请访问 Microsoft 基准安全分析器 Web 站点。

通过查看下面的注册表项，还可以验证此安全更新安装的文件：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB828741\\File 1

**注意** ：如果管理员或 OEM 将 828741 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

### 其他信息

**鸣谢**  

Microsoft 感谢以下与我们一起致力于为客户提供安全保护的组织/人员：

-   [eEye Digital Security](http://www.eeye.com/html/)向我们报告了 RPC 运行时库漏洞 (CAN-2003-0813) 和 RPCSS 服务漏洞 (CAN-2004-0116)。
-   [Qualys](http://www.qualys.com/) 向我们报告了 CIS - RPC over HTTP 漏洞 (CAN-2003-0807)。
-   [BindView](http://www.bindview.com/) 的 Todd Sabin 向我们报告了对象标识漏洞 (CAN-2004-0124)。

**获取其他安全更新：**  

从以下位置可获得针对其他安全问题的更新：

-   安全更新可以从 [Microsoft 下载中心](http://www.microsoft.com/downloads/search.aspx?langid=24&displaylang=zh-cn) 获得，并可通过搜索关键字“security\_patch”轻松找到。
-   有关用户平台的更新可从 [WindowsUpdate](http://go.microsoft.com/fwlink/?linkid=21130) Web 站点获得。

**支持：**  

-   美国和加拿大的客户可致电 1-866-PCSAFETY 从 [Microsoft 产品支持服务](http://go.microsoft.com/fwlink/?linkid=21131) 获得技术支持与安全更新有关的电话支持服务是免费的。
-   其他国家/地区的客户可从当地的 Microsoft 分公司获得支持。与安全更新有关的支持服务不收取任何费用。有关如何联系 Microsoft 支持的信息可在 [国际支持 Web 站点](http://go.microsoft.com/fwlink/?linkid=21155) 中找到。

**安全性资源：**  

-   [Microsoft TechNet 安全性](http://www.microsoft.com/china/technet/security/) Web 站点提供了更多有关 Microsoft 产品安全性的信息。
-   [Microsoft 软件更新服务](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft 基准安全分析器](http://www.microsoft.com/china/technet/security/tools/tools/mbsahome.asp) (MBSA)：请查看知识库文章 [306460](http://support.microsoft.com/default.aspx?scid=306460) ，此文章中列出了具有 MBSA 工具检测限制的安全更新。
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   Windows Update 目录：有关“Windows Update 目录”的更多信息，请查看知识库文章 [323166](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;323166) for more information on the Windows Update Catalog.
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Systems Management Server (SMS):**  

Systems Management Server 可以为部署此安全更新提供支持。有关 Systems Management Server 的信息，请访问 [SMS Web 站点](http://www.microsoft.com/china/smserver/default.asp) 。有关 SMS 2003 提供的许多安全更新部署进程增强功能的详细信息，请访问 [SMS 2003 Security Patch Management Web site](http://go.microsoft.com/fwlink/?linkid=22939) Web 站点。对于 SMS 2.0 用户，它还提供了几种额外的工具来帮助管理员部署安全更新，如 [SMS 2.0 Software Update Services Feature Pack](http://go.microsoft.com/fwlink/?linkid=21157) 和 [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161) 。SMS 2.0 Software Update Services Feature Pack 利用 Microsoft 基准安全分析器和 Microsoft Office 检测工具来为安全公告补救措施提供广泛的支持。某些软件更新在重新启动计算机后可能需要管理权限

**注意：** 可以使用 SMS 2.0 软件更新服务功能包的清点功能针对特定计算机进行更新，也可以使用 SMS 2.0 管理功能包的提升权限部署工具进行安装。这样，对于那些需要在重新启动计算机后使用 Systems Management Server 和管理权限明确确定目标的更新，便提供了一种最佳部署方式。

**免责声明：**  

Microsoft 知识库中的信息“按原样”提供，没有任何形式的担保。Microsoft 不作任何明示或默示的保证，包括对适销性和针对特定目的的适用性的保证。Microsoft Corporation 或其供应商不对任何损害（包括直接的、间接的、偶然的、后果性的损害，商业利润损失，或特殊损害）承担任何责任，即使 Microsoft Corporation 或其供应商事先已被告知发生此类损害的可能性。有些州不允许排除或限制后果性的或偶然的损害赔偿责任，因此上述限制可能不适用。

**修订版本：**  

-   1.0 版（2004 年 3 月 9 日）：公告发布

*Built at 2014-04-18T01:50:00Z-07:00*